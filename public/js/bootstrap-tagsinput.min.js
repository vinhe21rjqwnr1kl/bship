!function(t){"use strict";var e={tagClass:function(t){return"label label-primary"},itemValue:function(t){return t?t.toString():t},itemText:function(t){return this.itemValue(t)},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],onTagExists:function(t,e){e.hide().fadeIn()},trimValue:!1,allowDuplicates:!1};function n(e,n){this.itemsArray=[],this.$element=t(e),this.$element.hide(),this.isSelect="SELECT"===e.tagName,this.multiple=this.isSelect&&e.hasAttribute("multiple"),this.objectItems=n&&n.itemValue,this.placeholderText=e.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=t('<div class="bootstrap-tagsinput w-100"></div>'),this.$input=t('<input type="text" class="form-control w-100" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.after(this.$container);var i=(this.inputSize<3?3:this.inputSize)+"em";this.$input.get(0).style.cssText="width: "+i+" !important;",this.build(n)}function i(t,e){if("function"!=typeof t[e]){var n=t[e];t[e]=function(t){return t[n]}}}function a(t,e){if("function"!=typeof t[e]){var n=t[e];t[e]=function(){return n}}}n.prototype={constructor:n,add:function(e,n){var i=this;if(!(i.options.maxTags&&i.itemsArray.length>=i.options.maxTags)&&(!1===e||e)){if("string"==typeof e&&i.options.trimValue&&(e=t.trim(e)),"object"==typeof e&&!i.objectItems)throw"Can't add objects when itemValue option is not set";if(!e.toString().match(/^\s*$/)){if(i.isSelect&&!i.multiple&&i.itemsArray.length>0&&i.remove(i.itemsArray[0]),"string"==typeof e&&"INPUT"===this.$element[0].tagName){var a=e.split(",");if(a.length>1){for(var r=0;r<a.length;r++)this.add(a[r],!0);return void(n||i.pushVal())}}var s=i.options.itemValue(e),l=i.options.itemText(e),u=i.options.tagClass(e),p=t.grep(i.itemsArray,(function(t){return i.options.itemValue(t)===s}))[0];if(!p||i.options.allowDuplicates){if(!(i.items().toString().length+e.length+1>i.options.maxInputLength)){var c=t.Event("beforeItemAdd",{item:e,cancel:!1});if(i.$element.trigger(c),!c.cancel){i.itemsArray.push(e);var h=t('<span class="tag '+o(u)+'">'+o(l)+'<span data-role="remove"></span></span>');if(h.data("item",e),i.findInputWrapper().before(h),h.after(" "),i.isSelect&&!t('option[value="'+encodeURIComponent(s)+'"]',i.$element)[0]){var m=t("<option selected>"+o(l)+"</option>");m.data("item",e),m.attr("value",s),i.$element.append(m)}n||i.pushVal(),i.options.maxTags!==i.itemsArray.length&&i.items().toString().length!==i.options.maxInputLength||i.$container.addClass("bootstrap-tagsinput-max"),i.$element.trigger(t.Event("itemAdded",{item:e}))}}}else if(i.options.onTagExists){var f=t(".tag",i.$container).filter((function(){return t(this).data("item")===p}));i.options.onTagExists(e,f)}}}},remove:function(e,n){var i=this;if(i.objectItems&&(e=(e="object"==typeof e?t.grep(i.itemsArray,(function(t){return i.options.itemValue(t)==i.options.itemValue(e)})):t.grep(i.itemsArray,(function(t){return i.options.itemValue(t)==e})))[e.length-1]),e){var a=t.Event("beforeItemRemove",{item:e,cancel:!1});if(i.$element.trigger(a),a.cancel)return;t(".tag",i.$container).filter((function(){return t(this).data("item")===e})).remove(),t("option",i.$element).filter((function(){return t(this).data("item")===e})).remove(),-1!==t.inArray(e,i.itemsArray)&&i.itemsArray.splice(t.inArray(e,i.itemsArray),1)}n||i.pushVal(),i.options.maxTags>i.itemsArray.length&&i.$container.removeClass("bootstrap-tagsinput-max"),i.$element.trigger(t.Event("itemRemoved",{item:e}))},removeAll:function(){var e=this;for(t(".tag",e.$container).remove(),t("option",e.$element).remove();e.itemsArray.length>0;)e.itemsArray.pop();e.pushVal()},refresh:function(){var e=this;t(".tag",e.$container).each((function(){var n=t(this),i=n.data("item"),a=e.options.itemValue(i),r=e.options.itemText(i),s=e.options.tagClass(i);(n.attr("class",null),n.addClass("tag "+o(s)),n.contents().filter((function(){return 3==this.nodeType}))[0].nodeValue=o(r),e.isSelect)&&t("option",e.$element).filter((function(){return t(this).data("item")===i})).attr("value",a)}))},items:function(){return this.itemsArray},pushVal:function(){var e=this,n=t.map(e.items(),(function(t){return e.options.itemValue(t).toString()}));e.$element.val(n,!0).trigger("change")},build:function(n){var r=this;if(r.options=t.extend({},e,n),r.objectItems&&(r.options.freeInput=!1),i(r.options,"itemValue"),i(r.options,"itemText"),a(r.options,"tagClass"),r.options.typeahead){var o=r.options.typeahead||{};a(o,"source"),r.$input.typeahead(t.extend({},o,{source:function(e,n){function i(t){for(var e=[],i=0;i<t.length;i++){var o=r.options.itemText(t[i]);a[o]=t[i],e.push(o)}n(e)}this.map={};var a=this.map,s=o.source(e);t.isFunction(s.success)?s.success(i):t.isFunction(s.then)?s.then(i):t.when(s).then(i)},updater:function(t){r.add(this.map[t])},matcher:function(t){return-1!==t.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(t){return t.sort()},highlighter:function(t){var e=new RegExp("("+this.query+")","gi");return t.replace(e,"<strong>$1</strong>")}}))}if(r.options.typeaheadjs){var l=r.options.typeaheadjs||{};r.$input.typeahead(null,l).on("typeahead:selected",t.proxy((function(t,e){l.valueKey?r.add(e[l.valueKey]):r.add(e),r.$input.typeahead("val","")}),r))}r.$container.on("click",t.proxy((function(t){r.$element.attr("disabled")||r.$input.removeAttr("disabled"),r.$input.focus()}),r)),r.options.addOnBlur&&r.options.freeInput&&r.$input.on("focusout",t.proxy((function(e){0===t(".typeahead, .twitter-typeahead",r.$container).length&&(r.add(r.$input.val()),r.$input.val(""))}),r)),r.$container.on("keydown","input",t.proxy((function(e){var n=t(e.target),i=r.findInputWrapper();if(r.$element.attr("disabled"))r.$input.attr("disabled","disabled");else{switch(e.which){case 8:if(0===s(n[0])){var a=i.prev();a&&r.remove(a.data("item"))}break;case 46:if(0===s(n[0])){var o=i.next();o&&r.remove(o.data("item"))}break;case 37:var l=i.prev();0===n.val().length&&l[0]&&(l.before(i),n.focus());break;case 39:var u=i.next();0===n.val().length&&u[0]&&(u.after(i),n.focus())}var p=n.val().length;Math.ceil(p/5);n.attr("size",Math.max(this.inputSize,n.val().length))}}),r)),r.$container.on("keypress","input",t.proxy((function(e){var n=t(e.target);if(r.$element.attr("disabled"))r.$input.attr("disabled","disabled");else{var i,a,o,s=n.val(),l=r.options.maxChars&&s.length>=r.options.maxChars;r.options.freeInput&&(i=e,a=r.options.confirmKeys,o=!1,t.each(a,(function(t,e){if("number"==typeof e&&i.which===e)return o=!0,!1;if(i.which===e.which){var n=!e.hasOwnProperty("altKey")||i.altKey===e.altKey,a=!e.hasOwnProperty("shiftKey")||i.shiftKey===e.shiftKey,r=!e.hasOwnProperty("ctrlKey")||i.ctrlKey===e.ctrlKey;if(n&&a&&r)return o=!0,!1}})),o||l)&&(r.add(l?s.substr(0,r.options.maxChars):s),n.val(""),e.preventDefault());var u=n.val().length;Math.ceil(u/5);n.attr("size",Math.max(this.inputSize,n.val().length))}}),r)),r.$container.on("click","[data-role=remove]",t.proxy((function(e){r.$element.attr("disabled")||r.remove(t(e.target).closest(".tag").data("item"))}),r)),r.options.itemValue===e.itemValue&&("INPUT"===r.$element[0].tagName?r.add(r.$element.val()):t("option",r.$element).each((function(){r.add(t(this).attr("value"),!0)})))},destroy:function(){var t=this;t.$container.off("keypress","input"),t.$container.off("click","[role=remove]"),t.$container.remove(),t.$element.removeData("tagsinput"),t.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var e=this.$input[0],n=this.$container[0];e&&e.parentNode!==n;)e=e.parentNode;return t(e)}},t.fn.tagsinput=function(e,i){var a=[];return this.each((function(){var r=t(this).data("tagsinput");if(r)if(e||i){if(void 0!==r[e]){var o=r[e](i);void 0!==o&&a.push(o)}}else a.push(r);else r=new n(this,e),t(this).data("tagsinput",r),a.push(r),"SELECT"===this.tagName&&t("option",t(this)).attr("selected","selected"),t(this).val(t(this).val())})),"string"==typeof e?a.length>1?a:a[0]:a},t.fn.tagsinput.Constructor=n;var r=t("<div />");function o(t){return t?r.text(t).html():""}function s(t){var e=0;if(document.selection){t.focus();var n=document.selection.createRange();n.moveStart("character",-t.value.length),e=n.text.length}else(t.selectionStart||"0"==t.selectionStart)&&(e=t.selectionStart);return e}t((function(){t("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()}))}(window.jQuery);